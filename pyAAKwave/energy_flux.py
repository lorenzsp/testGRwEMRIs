"""
Python 5pn trajectory developed by Lorenzo Speri, Priti Gupta and Michael Katz 30/06/2021
"""

import numpy as np
from constants import *
import cmath
from numba import njit


#@njit(fastmath=True)
def fluxes(q,E,L,Q):
    r1,r2,Y = roots(q,E,L,Q)
    p= 2*r1*r2/(r1+r2)
    v = 1/np.sqrt(p)
    e =  np.abs((r1-r2)/(r1+r2))
    LOGV=np.log(v)
    SQRT1MQ2 = np.sqrt(1 - q**2)
    COSHARG=np.cosh((Pi*q)/SQRT1MQ2)
    SINHARG=np.sinh((Pi*q)/SQRT1MQ2)
    ONEOVERCOSHARG = (1.0/COSHARG)
    ONEOVERSINHARG =(1.0/SINHARG)
    

    x0 = e**2
    x1 = e**4
    x2 = v**2
    x3 = e**6
    x4 = q**2
    x5 = Y**2
    x6 = x4*x5
    x7 = v**5
    x8 = Y*q
    x9 = x7*x8
    x10 = v**3
    x11 = e**8
    x12 = e**10
    x13 = v**4
    x14 = 3.42708333333333*x4
    x15 = 5*x5
    x16 = v**7
    x17 = x16*x8
    x18 = v**6
    x19 = 52.948926182378*x4
    x20 = q**3
    x21 = Y*x20
    x22 = Y**3
    x23 = x20*x22
    x24 = q**4
    x25 = x24*x5
    x26 = Y**4
    x27 = x24*x26
    x28 = v**9
    x29 = x28*x8
    x30 = v**8
    x31 = v**10
    x32 = 6*x5
    x33 = x26 + 1
    x34 = q*(x4 + 0.333333333333333)
    x35 = SQRT1MQ2*x34
    x36 = 0.589048622548086*x35
    x37 = 0.222222222222222*x26
    x38 = -x37
    x39 = COSHARG**2*q
    x40 = SQRT1MQ2*x39
    x41 = 1.76714586764426*x40
    x42 = Y + 1
    x43 = Y - 1
    x44 = (q - 1)**3*(q + 1)**3
    x45 = COSHARG*SINHARG
    x46 = 0.1875*x45
    x47 = 3.14159265358979*x35
    x48 = 9.42477796076938*x40
    x49 = ONEOVERCOSHARG*ONEOVERSINHARG
    x50 = x49/SQRT1MQ2
    x51 = x30*x50
    x52 = -x26
    x53 = x42*x43*x44
    x54 = (1 - x0)**1.5
    x55 = 6.4*x54
    x56 = 0.875*x0
    x57 = 0.5859375*x11
    x58 = 0.24169921875*x12
    x59 = 0.033406692713954*x3
    x60 = 0.00928910588219638*x11
    x61 = 0.000546906761458672*x12
    x62 = q*x5
    x63 = x4*(15*x26 + x32 + 11)
    x64 = 0.9375*x8
    x65 = 0.38671875*x8
    x66 = x22*x4
    x67 = 1.43154905059667e-8*Y
    x68 = LOGV*Y
    x69 = 0.12890625*x4
    x70 = 0.3125*x4
    x71 = Y**6
    x72 = x34*(x5 + 1)
    x73 = 0.148148148148148*x5
    x74 = x39*(x4*(x5 + 0.777777777777778) + x73 + 0.444444444444444)
    x75 = Y*x4
    x76 = x20*x5
    x77 = x20*x26
    x78 = Y*x24
    x79 = x22*x24
    x80 = Y**5*x24
    x81 = 2902.09857363113*x0
    x82 = 5513.26696758358*x1
    x83 = 1864.4981776311*x3
    x84 = 58.371605081657*x11
    x85 = 0.0392163324705029*x12
    x86 = 3*x4 + 45*x6 + 16
    x87 = x12*x86
    x88 = x35*(x5 + 0.333333333333333)
    x89 = 0.333333333333333*x5
    x90 = x40*(x4*(x5 + 0.166666666666667) + x89 + 0.333333333333333)

    fluxE = -v**10.0*x55*(3.04166666666667*x0 + 0.385416666666667*x1 - x10*(x0*(34.2916666666667*x8 - 89.9935395559576) + x1*(29.65625*x8 - 64.3862869368533) - 0.0329663834137275*x11 + 0.00844602009870636*x12 + x3*(2.55729166666667*x8 - 3.41123238763814) + 6.08333333333333*x8 - 12.5663706143592) - x13*(x0*(22.8072916666667*x4 - 34.0260416666667*x6 + 66.4185956790123) + x1*(14.93359375*x4 - 26.37890625*x6 + 114.266906415344) - 3.07504030257937*x11 + 0.80322265625*x12 + x14 - x3*(x4*(1.85872395833333*x5 - 0.708984375) + 1.62456597222222) - 5.48958333333333*x6 + 4.92846119929453) - x16*(x0*(0.0104166666666667*x21*(37293*x5 - 24299) - x4*(876.897049433251*x5 - 653.353097176252) - 672.568507495591*x8 + 1480.32119843455) + x1*(-457.9140625*x21 + 677.3046875*x23 + 1063.66023301219*x4 - 1485.93037368591*x6 - 1727.51807760141*x8 + 4249.61603303526) + x11*(-4.56803385416667*x21 + 10.34375*x23 + 8.20572396126888*x4 - 20.191413605225*x6 + 180.776715959821*x8 + 120.826868631824) - x12*(-0.642578125*x21 + 1.28515625*x23 + 0.0336278238564669*x4 + 0.196393855849901*x6 - 0.309527684771825*x8 + 5.39704745505292) + x19 - 21.8541666666667*x21 + 34.4375*x23 + x3*(-147.90234375*x21 + 247.81640625*x23 + 301.91474663956*x4 - 524.831982523552*x6 - 767.204282407407*x8 + 3138.21032597839) - 78.474366492795*x6 - 64.6751543209876*x8 + 101.509595959742) - x17*(0.09375*x0*(381*x4 - 65*x6 + 152) + 0.234375*x1*(297*x4 - 30*x6 + 124) + 0.025634765625*x11*(x15*x4 + 33*x4 + 16) + x3*(0.29296875*x4*(x5 + 84.6) + 11.09375) - 0.09375*x4*(x15 - 27) + 1) + x18*(-LOGV*(230.984126984127*x0 + 439.124603174603*x1 + 4.72901785714286*x11 + 148.696031746032*x3 + 16.3047619047619) + x0*(153.08556547619*x4 + 71.3385416666667*x6 - 851.960657745382*x8 + 1664.66967018675) + x1*(116.390066964286*x4 + 263.231584821429*x6 - 1383.31524020723*x8 + 2856.88601921021) + x11*(-0.146216982886905*x4 + 12.9109816778274*x6 - 25.747675777062*x8 + 5.57127280253917) - x12*(-0.428385416666667*x4 + 1.6064453125*x6 + 0.406403531124199*x8 - 4.25602641562) + x3*(0.302548363095238*x4 + 188.192057291667*x6 - 553.131541867706*x8 + 608.792785403937) + 16.875*x4 + 3.47619047619048*x6 - 88.4881930761125*x8 + 115.731716675611) + x2*(-13.6622023809524*x0 + 6.3203125*x1 + 1.60137648809524*x3 - 3.71130952380952) - x28*(-LOGV*(x0*(2529.46031746032*x8 - 5217.00106704879) + x1*(7570.85952380952*x8 - 20252.1953848909) + x11*(1680.7238343254*x8 - 3728.11638975339) + x12*(47.9209821428571*x8 - 80.6222481356444) + x3*(6822.51984126984*x8 - 18430.3788055766) + 152.111111111111*x8 - 204.891680874123) + x0*(x21*(2723.2068452381*x5 - 737.206845238095) - x4*(348.783403142684*x5 + 5029.35674542618) + 13979.8940404729*x8 - 20537.2406697997) + x1*(x21*(6517.87574404762*x5 - 2129.73586309524) - x4*(1497.59890899746*x5 + 12600.99243291) + 32495.1055186625*x8 - 79265.7046657278) + x11*(x21*(1168.75211588542*x5 - 258.973795572917) - x4*(2740.03644489365*x5 + 464.550333309251) + 3624.11168787535*x8 - 4188.05990519747) - x12*(3.48772321428571e-5*x21*(1246121*x5 - 1227693) + x4*(113.33611799629*x5 + 6.56940815283664) - 202.766451757401*x8 - 1212.61362000555) + 3.68154761904762*x21 + 72.0982142857143*x23 + x3*(x21*(4632.55171130952*x5 - 1718.28162202381) - x4*(4733.14591561331*x5 + 6160.88064561164) + 22584.9745130658*x8 - 62681.377712484) - 252.920414812051*x4 - 113.294853817349*x6 + 813.167480357931*x8 - 719.12834223343) - x29*(0.000651041666666667*x0*(-9009*x24 - 12606*x25 + 26415*x27 + 407832*x4 + 28888*x6 + 188160) + 0.00048828125*x1*(-20835*x24 - 45690*x25 + 85725*x27 + 1667904*x4 + 134560*x6 + 774528) + 0.000101725260416667*x11*(-873*x24 - 3054*x25 + 7335*x27 + 1253424*x4 - 174328*x6 + 510240) + 0.0018310546875*x12*(1089*x4 - 1335*x6 + 128) - 0.450334821428571*x24 - 0.2421875*x25 + 0.99609375*x27 + 0.000406901041666667*x3*(-7659*x24 - 22218*x25 + 45045*x27 + 1579632*x4 - 5456*x6 + 698880) + 14.0401785714286*x4 - 0.197916666666667*x6 + 6.14285714285714) + x30*(LOGV*(1413.78741496599*x0 + 4369.91037414966*x1 - 153.368276998299*x11 - 18.1013791454082*x12 + 1999.66652494331*x3 + 52.7430839002268) + x0*(x24*(256.991536458333*x26 - 421.243489583333*x5 + 181.689453125) + x4*(1261.7782462522*x5 - 577.069361772487) + 805.103242318402*x8 - 3997.64983153147) - x1*(-x24*(514.445149739583*x26 - 797.491861979167*x5 + 311.16650390625) - x4*(3056.24957975088*x5 - 1286.66519923942) + 1110.22655732299*x8 + 11257.3926691992) + x11*(x24*(6.93648274739583*x26 - 8.76700846354167*x5 + 2.4879150390625) + x4*(754.476605127728*x5 - 41.2581961495536) - 1592.98225624558*x8 + 2344.4836601133) - x12*(x24*(0.50201416015625*x26 - 0.3614501953125*x5 + 0.02008056640625) + x4*(20.5650615389385*x5 - 22.0956449962798) + 77.9052828812993*x8 - 86.1967208459973) + x24*(17.0403645833333*x26 - 29.9140625*x5 + 13.9361979166667) + x3*(x24*(188.403076171875*x26 - 268.023600260417*x5 + 92.7090657552083) + x4*(2283.68091724537*x5 - 736.709948881173) - 2881.83326544732*x8 + 84.4610101894941) + x4*(6.93953924162258*x5 - 20.6180004409171) + 110.904765656415*x8 - 117.504390722677) + x31*x50*(9.5625*x0*(x45*(SQRT1MQ2*(-x24*(24.6691176470588*x26 - 69.9754901960784*x5 + 26.8619281045752) + x4*(46.6503267973856*x5 + 2.74618736383442) + 4.7843137254902) + x44*(x26 + 0.0784313725490196*x5 - 1.18300653594771)) - x47*(6.47058823529412*x5 + x52 + 3.7843137254902) + x48*(x37 + x4*(4.83333333333333*x5 + x52 + 1.93790849673203) + 0.745098039215686*x5 + 1.62091503267974)) + 36.216796875*x1*(x45*(SQRT1MQ2*(-x24*(15.9669417030685*x26 - 57.3314997573208*x5 + 22.6172140430351) + x4*(40.6152905858455*x5 + 7.60286900717252) + 5.23065307663269) - x44*(0.0520951302378256*x5 + x52 + 1.22876557191393)) - x47*(5.68742921857305*x5 + x52 + 4.58097395243488) + x48*(x37 + x4*(4.27859569648924*x5 + x52 + 2.43525858814647) + 0.614571536428841*x5 + 1.84295960739902)) - 0.9613037109375*x11*(-x45*(SQRT1MQ2*(-x24*(29.0895238095238*x26 - 356.172952380952*x5 + 122.408888888889) + x4*(357.250031746032*x5 + 122.619259259259) + 53.3333333333333) - x44*(x26 - 9.14666666666667*x5 + 13.5155555555556)) + x47*(x26 + 48.88*x5 + 47.5066666666667) - x48*(x38 + x4*(x26 + 34.3733333333333*x5 + 25.6755555555556) + 8.48*x5 + 18.5511111111111)) - 0.16021728515625*x12*(-x45*(SQRT1MQ2*(-x24*(14.3733333333333*x26 - 41.856*x5 + 14.96) + x4*(51.4275555555556*x5 + 20.48) + 8.53333333333333) - x44*(x26 - 2.32*x5 + 2.28)) + x47*(x26 + 7.92*x5 + 7.4) - x48*(x38 + x4*(x26 + 5.36*x5 + 3.98666666666667) + 1.65333333333333*x5 + 2.90666666666667)) + 19.1748046875*x3*(x45*(SQRT1MQ2*(-x24*(16.7983193277311*x26 - 87.4343773873186*x5 + 33.4848484848485) + x4*(72.5976402682285*x5 + 21.5638740344623) + 10.6666666666667) + x44*(x26 + 0.695187165775401*x5 - 2.5650623885918)) - x47*(10.1711229946524*x5 + x52 + 9.6096256684492) + x48*(x37 + x4*(7.45454545454546*x5 + x52 + 5.18181818181818) + 1.36185383244207*x5 + 3.76827094474153)) - x36*(18*x5 + x52 + 7) + x41*(x37 + x4*(13*x5 + x52 + 3.33333333333333) + 2.66666666666667*x5 + 3.33333333333333) + x46*(SQRT1MQ2*(-x24*(79.0277777777778*x26 - 188.666666666667*x5 + 68.4166666666667) + x4*(130.111111111111*x5 - 3.66666666666667) + 10.6666666666667) + x53*(x5 + 3))) + x31*(-LOGV*(x0*(x4*(2110.42638888889*x5 - 1709.81329365079) - 906.524834194808) + x1*(x4*(6696.51220238095*x5 - 5560.59255952381) - 787.580386823641) + x11*(x4*(1273.61878410218*x5 - 731.025685143849) - 8945.17941658431) + x12*(x4*(32.3463030133929*x5 - 13.1884068080357) - 555.45276426306) + x3*(x4*(5785.19171626984*x5 - 4271.10987103175) - 9482.60502418046) + x4*(114.090873015873*x5 - 81.2265873015873) - 116.639876594109) - x0*(x21*(7371.4199124137*x5 - 4864.52714961947) + x24*(-3109.662109375*x26 + 175.101748511905*x5 + 1514.291015625) + x4*(308.189327393643*x5 - 335.648683021611) + x4*(4131.72583487575*x5 - 3213.5645382367) - x4*(20620.1519692588*x5 - 15565.7435110376) - 16680.5727321066*x8 + 26994.3964541884) - x1*(x21*(21284.4599886114*x5 - 14708.3825257161) + x24*(-7254.08084542411*x26 + 980.031482514881*x5 + 3242.03485398065) - x4*(52435.6178002461*x5 - 43167.9272122956) - x4*(59999.319624057*x5 - 53311.5440968976) + x4*(73186.5773499303*x5 - 60671.4536178081) - 57227.745979327*x8 + 124459.059097873) - x11*(x21*(4261.93385399551*x5 - 2479.85430521231) - x24*(1447.40227835519*x26 - 1022.64848109654*x5 + 45.4563264392671) - x4*(29433.0720159355*x5 - 22544.2074359249) + x4*(942417.75744219*x5 - 884944.245095725) + x4*(5557627.20464721*x5 - 5349403.71062255) - x4*(6479895.6777768*x5 - 6219454.17033157) - 18374.1477523171*x8 + 66500.3858577311) + x12*(-102.501189776353*x21*(x5 - 0.44788520642064) - x24*(38.3498782203311*x26 - 32.9464954194568*x5 + 3.17462594168527) + x4*(11959.4016843535*x5 - 8262.98402789778) - x4*(15414420.0253759*x5 - 15566121.1854747) + x4*(22443338.789651*x5 - 22924782.2023074) + x4*(30066641.9602656*x5 - 31356396.5743878) - x4*(37106194.002573*x5 - 38722899.1652183) + 1175.93212765368*x8 + 990.224930763245) + 318.937104186314*x21 - 498.924183298229*x23 - 95.3128720238095*x24 + 20.8058035714286*x25 + 124.34337797619*x27 - x3*(x21*(17773.2710266423*x5 - 12104.0573823844) + x24*(-5485.06327892485*x26 + 2639.72663225446*x5 + 1132.3215797061) - x4*(60475.3669225324*x5 - 52939.6392278218) + x4*(295789.009175333*x5 - 261123.638137122) + x4*(517895.988947487*x5 - 462282.996845744) - x4*(783304.22357965*x5 - 698820.451362716) - 58799.6318921795*x8 + 184256.083025263) - 547.79015237399*x4 + 436.615081208027*x6 + 1090.20225618845*x8 - 1216.90699131704) - x51*(3.2578125*x0*(x45*(-SQRT1MQ2*(x24*(10.083932853717*x26 + 11.8561151079137*x5 - 7.76258992805755) + x4*(32.617106314948*x5 - 0.700239808153477) + 2.378896882494) + x44*(x26 - 1.8273381294964*x5 + 0.884892086330935)) + x47*(x33 + 4.96402877697842*x5) - x48*(x38 + x4*(x26 + 3.26618705035971*x5 + 0.376498800959233) + 1.16067146282974*x5 + 0.609112709832134)) + 7.294921875*x1*(x45*(-SQRT1MQ2*(-x24*(-9.13654618473896*x26 - 9.63855421686747*x5 + 6.08433734939759) + x4*(28.2998661311914*x5 + 0.176706827309237) + 2.18473895582329) + x44*(x26 - 1.71084337349398*x5 + 0.807228915662651)) + x47*(x33 + 4.26506024096386*x5) - x48*(x38 + x4*(x26 + 2.7710843373494*x5 + 0.405622489959839) + 1.04417670682731*x5 + 0.570281124497992)) + 0.1007080078125*x11*(x45*(-SQRT1MQ2*(-x24*(-10.1212121212121*x26 - 8.14545454545454*x5 + 3.96363636363636) + x4*(24.0080808080808*x5 + 1.28484848484848) + 1.93939393939394) + x44*(x26 - 1.56363636363636*x5 + 0.709090909090909)) + x47*(x33 + 3.38181818181818*x5) - x48*(x38 + x4*(x26 + 2.14545454545455*x5 + 0.442424242424242) + 0.896969696969697*x5 + 0.521212121212121)) + 2.8271484375*x3*(x45*(-SQRT1MQ2*(-x24*(-9.2832469775475*x26 - 8.53886010362694*x5 + 4.87564766839378) + x4*(25.6327000575705*x5 + 0.808290155440414) + 2.04490500863558) + x44*(x26 - 1.62694300518135*x5 + 0.751295336787565)) + x47*(x33 + 3.76165803108808*x5) - x48*(x38 + x4*(x26 + 2.41450777202073*x5 + 0.426597582037997) + 0.96027633851468*x5 + 0.542314335060449)) + x36*(x32 + x33) - x41*(x38 + x4*(x26 + 4*x5 + 0.333333333333333) + 1.33333333333333*x5 + 0.666666666666667) + x46*(-SQRT1MQ2*(x24*(12.9166666666667*x26 + 16*x5 - 10.25) + x4*(39.7777777777778*x5 - 2) + 2.66666666666667) + x42**2*x43**2*x44)) - x7*(-x0*(31.4107142857143*x8 - 416.36387636014) + x1*(82.7403273809524*x8 + 314.932756909595) + x11*(10.0543387276786*x8 - 14.3238327844197) - x12*(1.28515625*x8 + 0.388035820685054) + x3*(110.904017857143*x8 - 127.185601760085) - 11.1577380952381*x8 + 38.2928354546934) - x9*(9*x4 + 15*x6 + 8)*(0.234375*x0 + 0.17578125*x1 + 0.009765625*x3 + 0.03125) + 1)

    fluxL = -v**7.0*x55*(Y*x13*(x0*(x4*(18.5*x5 - 12.5625) - 50.0815145502646) + x1*(x4*(5.171875*x5 - 2.7421875) - 29.0044229497354) + 10.0856274801587*x3 + x4*(5.625*x5 - 3.5625) - x57 - x58 - 4.92846119929453) - Y*x2*(1.26488095238095*x0 - 3.99962797619048*x1 + 3.71130952380952) + Y*x30*x49*(2.109375*x0*(x45*(x24*(x26 + 6.84444444444444*x5 + 4.06666666666667) + x4*(10.6518518518519*x5 + 14.3555555555556) + 1.77777777777778) - 8.37758040957278*x72 + 18.8495559215388*x74) + 3.1640625*x1*(x45*(x24*(x26 + 3.62222222222222*x5 + 2.4) + x4*(5.5037037037037*x5 + 7.35555555555556) + 0.888888888888889) - 4.18879020478639*x72 + 9.42477796076938*x74) + 0.263671875*x3*(x45*(x24*(x26 + 2.54814814814815*x5 + 1.84444444444444) + x4*(3.78765432098765*x5 + 5.02222222222222) + 0.592592592592593) - 2.79252680319093*x72 + 6.28318530717959*x74) + 1.8125*x45*(x24*(x5 + 0.517241379310345) + x4*(1.59770114942529*x5 + 2.17241379310345) + 0.275862068965517) - 2.35619449019234*x72 + 5.30143760293278*x74) - Y*x31*(32.34375*x0*x49*(-0.947030828908228*x34*(x5 - 7.61538461538461) + 2.13081936504351*x39*(x4*(x5 - 6.64102564102564) + x73 - 2.42735042735043) + x45*(x24*(x26 + 2.66570048309179*x5 - 8.24347826086957) + x4*(2.03349436392915*x5 - 12.4888888888889) - 0.881159420289855)) + 16.7578125*x1*x49*(-2.10904122199035*x34*(x5 - 13) + 4.74534274947829*x39*(x4*(x5 - 11.2777777777778) + x73 - 4.22222222222222) + x45*(x24*(x26 + 6.34638694638695*x5 - 27.9776223776224) + x4*(4.36177156177156*x5 - 46.4634032634033) - 3.46853146853147)) + 0.457763671875*x11*x49*(1.40743350880823*x34*(x5 + 9) - 3.16672539481851*x39*(x4*(x5 + 7.66666666666667) + x73 + 3.11111111111111) - x45*(-x24*(x26 + 2.13333333333333*x5 - 13.64) + x4*(0.577777777777778*x5 + 22.2453333333333) + 1.792)) + x12*x4*(0.158203125*x5 + 0.0296630859375*x63 + 0.158203125) - 0.751953125*x3*x49*(-1.95839542041961*x34*(x5 + 113) + 4.40638969594413*x39*(x4*(x5 + 97.2222222222222) + x73 + 37.7777777777778) + x45*(x24*(x26 - 34.7255411255411*x5 + 226.906493506494) - x4*(8.30822510822511*x5 - 379.812987012987) + 29.5064935064935)) + 6.40625*x49*(-0.367796213103195*x34*(x5 - 7) + 0.827541479482189*x39*(x4*(x5 - 6.11111111111111) + x73 - 2.22222222222222) + x45*(x24*(x26 + 1.54471544715447*x5 - 3.42926829268293) + x4*(1.08943089430894*x5 - 4.63414634146341) - 0.31219512195122))) + Y*x56 + Y - q*x16*(x0*(0.05859375*x4*(45*x26 - 114*x5 + 397) - 1.25*x5 + 10.0) + x1*(0.0439453125*x4*(75*x26 - 102*x5 + 419) - 0.46875*x5 + 7.96875) + x3*(0.00732421875*x4*(35*x26 - 30*x5 + 147) + 0.46875) + 0.1171875*x4*(x26 - 8.4*x5 + 25) - 0.25*x5 + 1.25) + q*x28*(-x0*(0.00334821428571429*x24*(-651*x26 + 501*x5 + 1785*x71 - 283) + 0.00111607142857143*x4*(14889*x26 - 18926*x5 + 165013) - 2.83928571428571*x5 + 80.6607142857143) - x1*(0.000627790178571429*x24*(-6258*x26 + 1773*x5 + 13405*x71 - 824) + 0.000209263392857143*x4*(156737*x26 - 333430*x5 + 1537173) - 12.5591517857143*x5 + 139.315848214286) + x11*(9.1552734375e-5*x4*(1255*x26 + 22062*x5 - 41733) + 0.59912109375*x5 - 1.58837890625) + x12*(0.098876953125*x5 + 0.0185394287109375*x63 + 0.098876953125) - 0.000558035714285714*x24*(210*x26 + 447*x5 + 175*x71 - 288) - x3*(6.97544642857143e-5*x24*(-4956*x26 + 771*x5 + 9835*x71 - 258) + 1.1625744047619e-5*x4*(814653*x26 - 3350766*x5 + 9642641) - 8.77064732142857*x5 + 47.7918526785714) - 0.00037202380952381*x4*(315*x26 - 3390*x5 + 40283) + 0.428571428571429*x5 - 6.57142857142857) - q*x7*(x0*(0.375*x5 + 0.0703125*x63 + 0.375) + x1*(0.046875*x5 + 0.0087890625*x63 + 0.046875) + 0.125*x5 + 0.0234375*x63 + 0.125) - x10*(Y*x59 + Y*x60 + Y*x61 - 12.5663706143592*Y - 2.54166666666667*q - x0*(38.0918109247762*Y + 7.875*q - 22.75*x62) - x1*(4.81056375080937*Y + 1.484375*q - 7.203125*x62) + 7.625*x62) - x16*(101.509595959742*Y + 11.9978505291005*q + x0*(1236.48162523476*Y + 176.204695767196*q + 42.2864583333333*x20 - 514.805941358025*x62 - 565.683027187012*x66 + 427.256600888212*x75 - 300.145833333333*x76 + 334.421875*x77) + x1*(1794.62902455724*Y - 4.13359788359788e-5*q*(18931354*x5 - 8084991) - x20*(-294.525390625*x26 + 260.74609375*x5 - 29.228515625) + x75*(309.434604532292 - 450.941264253166*x5)) - x11*(2.99016050607486e-9*Y*(80412460.0302893*x4 + 18414195789.7457) + 8.38112676711309*q - x62*(0.46875*x4 + 76.2264966207837) - 0.455443156980991*x66 + 0.9375*x77) + x12*(18.3365032848759*Y + 2.303466796875*q - 16.900146484375*x62 + 1.17179087963486e-6*x75*(25221*x5 + 7538) - x76*(0.38671875*x5 - 0.193359375)) + 6.36979166666667*x20 + x3*(-98.9053049520667*Y + 57.7639095568783*q + 2.0546875*x20 - 66.2245783730159*x62 - 30.5753050641366*x66 + 16.2240625819176*x75 - 31.35546875*x76 + 43.06640625*x77) - 71.7445436507936*x62 - 84.8230016469244*x66 + 59.2975613365073*x75 - 43.0520833333333*x76 + 47.203125*x77) - x18*(22.6031994879738*Y - 37.9609112308767*q + x0*(273.914841274389*Y - 260.490390860154*q + 688.794189299562*x62 - 145.817708333333*x66 + x67*(2435912325*x4 - 75762448154.9555)) + x1*(6.44197072768501e-8*Y*(1436866200*x4 - 13019246497.4966) + 465.612520279074*Y - 179.553473875873*q + 549.852345456032*x62 - 199.079613095238*x66) - x11*(Y*x70 + 19.9648154692259*Y - 0.0468041684377792*q + 0.771560378373396*x62 - 1.171875*x66) + x12*(-Y*x69 + 3.55767120956443*Y + 0.00252396653710443*q - 0.0470863924956986*x62 + 0.4833984375*x66) + x3*(5.36830893973751e-9*Y*(3551607675*x4 - 33878026262.2226) + 248.96407084461*Y - 8.80550423528962*q + 40.5700421087604*x62 - 51.3138950892857*x66) + 113.88273369263*x62 - 15.7946428571429*x66 + x67*(106652700*x4 - 9663302567.65754) + 0.0636904761904762*x68*(1832*x0 + 1308*x1 + 69*x3 + 256)) + x28*(-LOGV*(Y*x81 + Y*x82 + Y*x83 + Y*x84 + Y*x85 + 204.891680874123*Y + 658.130952380952*q*x0 + 1112.08035714286*q*x1 + 9.24888392857143*q*x11 + 332.237599206349*q*x3 + 51.9031746031746*q - 2059.34047619048*x0*x62 - 3467.67202380952*x1*x62 - 47.5368303571429*x11*x62 - 1237.65744047619*x3*x62 - 187.709523809524*x62) + 719.12834223343*Y + 0.00110023361993642*q*(236193*x5 - 65291) - 4.47359078311459e-10*q*(3064385109027.14*x5 - 1085062607874.68) + x0*(10370.3030731529*Y + 0.476719260975626*q*(10575*x5 - 3109) - 0.000550116809968211*q*(657039*x5 - 52195) - 6.71038617467189e-10*q*(26059911186269.9*x5 - 10268996592534.6) + x20*(-1947.78599330357*x26 + 520.377790178571*x5 + 238.135881696429) + x75*(3671.23502130555*x5 - 679.718866771614)) + x1*(14858.7744666755*Y - 0.17876972286586*q*(319283*x5 - 98513) + 0.000137529202492053*q*(508419243*x5 - 159053077) - 4.19399135916993e-11*q*(727712807084198.0*x5 - 310348520318227.0) + x20*(-3078.48979259673*x26 + 1495.06515066964*x5 + 113.008347284226) + x75*(8225.00275484227*x5 - 3219.36880316064)) + x11*(354.751077057794*Y - 0.0338377337067657*q*(126968067*x5 - 47438113) + 0.000232773076648255*q*(1797335039*x5 - 685184373) + 1.91012781238962e-6*q*(2033258900805*x5 - 757776756811) - 1.51692395803311e-14*q*(3.73051424477041e+17*x5 - 1.0853999550448e+17) - x20*(214.037856329055*x26 - 113.598673502604*x5 + 2.71058000837054) + x75*(267.533299714086*x5 - 96.5439371575562)) + x12*(3.82264837424343e-15*Y*(2.25040899209017e+15*x4 + 1.44451572892639e+18) - 5391.33035909571*Y + 14.7780860066414*q + 1.228515625*x20 - x62*(23.6875*x4 + 3643.17969913984) + 3551.97103987727*x62 - 36.0989240823236*x66 + 43.56396484375*x77) - x20*(62.2453497023809*x26 + 23.0316220238095*x5 - 29.848400297619) - x3*(577.511568248738*Y - 9.74526730754852*q*(40113*x5 - 13807) - 0.00744873845274416*q*(37581559*x5 - 12478801) + 2.29215337486754e-5*q*(28775015511*x5 - 9770616463) + 7.7666506651295e-13*q*(1.9208207219137e+16*x5 - 6.95108903373711e+15) + x20*(1689.53070359003*x26 - 1118.99583798363*x5 + 42.7819126674107) - x75*(4735.33710368597*x5 - 2205.94819204353)) + 337.097099220346*x75*(x5 - 0.176121431493693)) + x30*(-117.504390722677*Y - 154.096989654206*q + x0*(-620.410672758233*Y - 1473.64070398701*q + 1277.16961342188*x62 + 191.138172398589*x66 + 364.042658730159*x75 + 76.21875*x78 - 219.578125*x79 + 155.671875*x80) + x1*(2092.07943480296*Y - 1089.29889571409*q - 800.586472411825*x62 + 379.38386656746*x66 + 360.47693452381*x75 + 67.1015625*x78 - 218.47265625*x79 + 160.81640625*x80) - x11*(56.3099220606964*Y - 31.2148260424811*q + 180.037111919315*x62 - 159.108902219742*x66 + 38.5774390811012*x75 + 0.0146484375*x78 - 0.263671875*x79 + 0.3662109375*x80) - x12*(9.93653337403337e-10*Y*(6081075*x24 - 11029432050*x4 + 289681812863) - 333.31026372686*Y + 0.191906926536521*q - 31.8040495865222*x62 - x66*(0.1087646484375*x4 - 34.0947265625) + 0.15106201171875*x80) + x3*(1862.29857458203*Y + 331.206134133138*q - 2119.87212897134*x62 + 590.553736772487*x66 - 169.108372602513*x75 + 6.0263671875*x78 - 25.80859375*x79 + 21.4306640625*x80) + 226.708919855928*x62 - 63.816192680776*x66 + 1.77154195011338e-6*x68*(326160256*x0 + 262848736*x1 - 9716337*x11 - 85029328*x3 + 29772416) + 61.2954695767196*x75 + 9.046875*x78 - 23.5*x79 + 15.515625*x80) - x31*(8.82789463990744e-14*Y*(-173763489074175*x24 + 6.71452866071778e+15*x4 + 1.62114295119355e+16) + 178.000195967794*Y*(-0.745039682539682*x4 + x6 + 0.288650274883977) - 265.600731114992*Y + 127.79082616946*q*(x4 + 2.31140784098531) + x0*(6.62092097993058e-14*Y*(-4394769824820375*x24 + 1.47587780191321e+17*x4 + 3.59582204069422e+17) + 3596.13174516964*Y*(-0.787234042553192*x4 + x6 + 2.01365327851707) - 182.414883367789*Y*(-0.471442400774443*x4 + x6 + 87.5409025021803) + 4909.35223349647*Y + 1495.2508409531*q*(x4 + 3.29644194180815) - 8489.46692293344*x62*(x4 + 1.80213671307134) - x66*(14209.295276078 - 3006.10026041667*x4) + 8644.99212174787*x77 - 3600.68852306548*x80) - x1*(1.3230322510058e-7*Y*(320329650564*x4 - 2273184675677) - 1.82075326948091e-13*Y*(-4943861014917825*x24 + 9.4942896633008e+16*x4 + 3.73968777508843e+17) + 41546.7986729173*Y*(-0.824355432780847*x4 + x6 + 0.562557871961432) + 291917.200958195*Y - 14410.7542733063*q - 2279.18763198663*x20 + x62*(14692.7563747568*x4 + 37474.1711485572) - x66*(5256.20717075893*x4 - 22433.8779556926) - 51396.3646201025*x66 - 15056.3190253704*x77 + 5333.5072312128*x80) + x11*(-8.42208030154153e-10*Y*(3361115936848005*x4 - 5.12270169598515e+16) + 5.60364405853499e-16*Y*(-52042832277697800*x24 + 6.26423284684157e+18*x4 + 2.19732733770519e+19) - 3389698.76390143*Y*(-0.92254511779333*x4 + x6 + 11.9571834893013) + 340113.60442734*Y*(-0.881301089319641*x4 + x6 + 92.588587235881) - 34116144.3278956*Y + 71.0987150038023*q + 11.9836403414973*x20 + x62*(4928.65021300908 - 163.217705002032*x4) - x66*(5245.25603931248 - 202.675975981213*x4) + 3054003.76680356*x66 + 223.688202821303*x77 - 210.407940092541*x80) + x12*(2.45005972408481e-11*Y*(5.72710719652787e+17*x4 - 1.93526438277949e+19) + 1.07762385741058e-18*Y*(4.49310131327257e+18*x24 + 1.87424485536538e+21*x4 + 6.0700757706355e+21) + 17483925.1442528*Y*(-0.981895725426338*x4 + x6 + 13.0008644944353) - 9920232.50212932*Y*(-0.961927247517862*x4 + x6 + 21.9651511997037) + 6707657.58357076*Y*(-0.955471425102699*x4 + x6 + 69.2847440733428) + 65.8518101526783*q - 0.00911066521195744*x20 + x62*(12.1798609853499*x4 + 29.7017752663078) - x66*(32.2223205566406*x4 + 2686.49250958243) - 14268663.4303067*x66 - 24.9900032777728*x77 + 39.2895050048828*x80) + x3*(3.67508958612722e-9*Y*(118834314074091*x4 - 1061617280565091) + 9.65550976239876e-14*Y*(-5137779721134060*x24 + 7.85117436604436e+16*x4 + 4.20165618367301e+17) + 298746.041946554*Y*(-0.873182082606166*x4 + x6 + 15.7438605516839) - 209518.908489433*Y*(0.871876658316833*x4 - x6 + 8.70590406344361) + 1001960.99997656*Y + 9537.54738363145*q + 592.74324368276*x20 - x62*(5077.97978085631*x4 + 18081.8135592717) - x66*(11137.2111827759 - 2527.11263020833*x4) - 499587.194609505*x66 + 5710.70265448681*x77 - 2349.96563430059*x80) - 752.345990687806*x62*(x4 + 1.7067537990983) + x66*(218.700148809524*x4 - 591.634585361526) + x68*(x0*(x4*(1522.20238095238*x5 - 1237.37857142857) - 1623.26473770204) + x1*(x4*(2668.18511904762*x5 - 2132.35714285714) - 4847.32557529185) + x11*(x4*(33.5449776785714*x5 - 18.3010602678571) - 175.54241825676) - 17.80326071085*x12 + x3*(x4*(931.950892857143*x5 - 648.209821428571) - 3924.59094728146) + x4*(128.4*x5 - 95.5357142857143) - 116.639876594109) + 779.016803319844*x77 - 240.613467261905*x80) + x7*(Y*x11*(x64 - 0.712530715317219) + Y*x12*(x65 - 0.0176114297573003) - 38.2928354546934*Y - 11.7544642857143*q - x0*(113.043573154952*Y + 49.2105654761905*q - 41.1138392857143*x62) + x1*(121.074400859759*Y + 2.20926339285714*q - 47.9175967261905*x62) + x3*(22.1533163165696*Y + 5.34626116071429*q - 33.9186197916667*x62) + 19.2008928571429*x62))

    fluxQ = 12.8*x18*x54*(x5 - 1)*(-x10*(x0*(26.375*x8 - 38.0918109247762) + x1*(8.078125*x8 - 4.81056375080937) + x59 + x60 + x61 + 10.625*x8 - 12.5663706143592) - x13*(x0*(9.67708333333333*x4 - 20.375*x6 + 48.6313657407407) + x1*(1.36848958333333*x4 - 6.046875*x6 + 21.2936714616402) + x14 - 12.413566468254*x3 + x57 + x58 - 6.625*x6 + 7.12042548500882) - x16*(x0*(-248.932291666667*x21 + 439.171875*x23 + 342.335424470863*x4 - 616.341208726148*x6 - 635.48155037478*x8 + 1268.35920694111) + x1*(-195.986328125*x21 + 367.494140625*x23 + 215.499757005326*x4 - 493.843638928752*x6 - 739.215980489418*x8 + 1562.88459362496) - x11*(-0.46875*x21 + 0.9375*x23 + 0.147067744877446*x4 - 0.498138955577141*x6 - 110.448610336062*x8 + 66.7667087025313) + x12*(0.193359375*x21 - 0.38671875*x23 + 0.00763395126471214*x4 + 0.039389750418926*x6 - 19.260009765625*x8 + 18.7544595954931) + x19 - 39.890625*x21 + 77.703125*x23 + x3*(-17.8723958333333*x21 + 57.19140625*x23 + 9.47000198696038*x4 - 35.352462122232*x6 + 72.968589823082*x8 - 217.667929805003) - 97.3893722612836*x6 - 93.806712962963*x8 + 116.53734831832) - x17*(-0.01953125*x0*(141*x4 - 225*x6 + 32) - 0.01318359375*x1*(153*x4 - 305*x6 + 16) + 0.005859375*x3*(-18*x4 + 55*x6 + 4) - 0.36328125*x4 + 0.64453125*x6 - 0.0625) + x18*(-LOGV*(116.680952380952*x0 + 83.3071428571428*x1 + 4.39464285714286*x3 + 16.3047619047619) + x0*(12.6331845238095*x4 + 264.154017857143*x6 - 815.63599268825*x8 + 736.27615642877) + x1*(-36.8842075892857*x4 + 273.056547619048*x6 - 602.375847633237*x8 + 323.992470060433) + x11*(-1.171875*x6 + x70 + 0.83283438873394*x8 + 25.9020209503942) - x12*(0.4833984375*x6 - x69 - 0.058016218662271*x8 + 4.21318878768943) - x3*(4.55822172619048*x4 - 66.8525855654762*x6 + 45.2803857814279*x8 + 55.1718597658037) + 6.65104166666667*x4 + 52.3958333333333*x6 - 151.581845535708*x8 + 104.250855233812) + x2*(0.547619047619048*x0 + 4.43712797619048*x1 - 2.21130952380952) - x28*(LOGV*(-2425.6880952381*x0*x8 - 3834.27440476191*x1*x8 - 51.9314732142857*x11*x8 - 1334.14851190476*x3*x8 - 236.62380952381*x8 + x81 + x82 + x83 + x84 + x85 + 204.891680874123) + x0*(x21*(3366.86114211309*x5 - 848.127511160714) - x4*(7047.02358974341*x5 + 1077.55868332406) + 14244.9507608316*x8 - 8424.5733048863) + x1*(x21*(4986.29740978423*x5 - 1575.13204520089) - x4*(11941.892331497*x5 + 204.470380355401) + 18098.3536697583*x8 - 12085.840070908) + x11*(x21*(349.920017787388*x5 - 41.9353637695313) - x4*(351.070799399829*x5 - 9.85176557439801) + 94.5516248801723*x8 - 604.712057570927) + x12*(x21*(18.443359375 - 48.55908203125*x5) - x4*(7.52720584173721 - 38.1692754676329*x5) + 143.446897428483*x8 - 138.542503653094) - 44.7137276785714*x21 + 284.27771577381*x23 + x3*(x21*(2573.06153506324*x5 - 941.006103515625) - x4*(5940.63891773981*x5 - 416.086494689986) + 3609.99993019085*x8 + 870.307146808831) - 97.5752030767303*x4 - 880.784302843162*x6 + 1301.41863073517*x8 - 543.654380692883) + x29*(0.000139508928571429*x0*(1248*x24 + 50232*x25 - 52920*x27 + 116051*x4 - 182651*x6 + 23600) + 1.74386160714286e-5*x1*(4716*x24 + 392112*x25 - 550620*x27 + 2079051*x4 - 2433291*x6 + 736208) + 9.1552734375e-5*x11*(9141*x4 - 685*x6 + 6352) + 0.0318080357142857*x24 + 0.640625*x25 - 0.44921875*x27 + 1.1625744047619e-5*x3*(162*x24 + 39900*x25 - 70350*x27 + 1499273*x4 - 1053045*x6 + 753408) + 1.33961123511905*x4 - 1.6044921875*x6 + 0.0061798095703125*x87 + 0.381696428571429) + x30*(LOGV*(394.632766439909*x0 + 282.346371882086*x1 - 19.4102200255102*x11 - 198.878557256236*x3 + 28.2859410430839) + x0*(x24*(184.109375*x26 - 246.61328125*x5 + 97.5768229166667) + x4*(550.564580577601*x5 - 79.4832107032628) + 190.807341309435*x8 + 480.258210938666) + x1*(x24*(188.61328125*x26 - 221.99951171875*x5 + 67.33544921875) + x4*(1140.19627356151*x5 - 96.574619192295) - 2541.51317519602*x8 + 2897.855940468) - x11*(x24*(0.3662109375*x26 - 0.263671875*x5 + 0.0146484375) - x4*(247.966618613591*x5 + 4.43641686817956) + 226.092847059852*x8 + 36.074204859091) + x12*(-x24*(0.15106201171875*x26 - 0.1087646484375*x5 + 0.00604248046875) - x4*(38.3310546875*x5 - 6.46046956380208) + 33.1450599499988*x8 + 53.250022135675) + x24*(22.640625*x26 - 29.5872395833333*x5 + 13.9361979166667) + x3*(x24*(27.9150390625*x26 - 22.0524088541667*x5 + 3.59049479166667) + x4*(1058.9851552166*x5 - 177.707253430886) - 2733.74882711944*x8 + 1943.42504338041) - x4*(24.2602788800705*x5 - 3.01202188051146) + 76.5155460733693*x8 + 30.2938911359778) + x31*(-10.78125*x0*x50*(-0.20488647740803*x35*(x5 - 29.5333333333333) + 0.40977295481606*x40*(x4*(x5 - 20.3666666666667) + x89 - 22.0666666666667) + x45*(SQRT1MQ2*(x24*(x26 + 3.19782608695652*x5 + 10.245652173913) + x4*(2.86908212560386*x5 - 2.3951690821256) - 3.18840579710145) + 0.0217391304347826*x44*(x5 + 43.8))) + 10.46630859375*x1*x50*(0.474866349317981*x35*(x5 - 24.5555555555556) - 0.949732698635963*x40*(x4*(x5 - 16.9444444444444) + x89 - 18.3333333333333) - x45*(SQRT1MQ2*(x24*(4.1703289013296*x5 + x52 + 18.8243526941917) + x4*(3.36608350828085*x5 - 4.9974341031024) - 6.13575927221833) + 0.0503848845346396*x44*(x5 + 36.3333333333333))) + 0.128173828125*x11*x50*(-5.92414614676932*x35*(x5 + 2.03030303030303) + 11.8482922935386*x40*(x4*(x5 + 1.33333333333333) + x89 + 1.60606060606061) + x45*(SQRT1MQ2*(-x24*(4.57142857142857*x5 + x52 + 19.5142857142857) + x4*(6.50793650793651*x5 + 4.42539682539683) + 7.00952380952381) + 0.628571428571429*x44*(x5 - 3.54545454545455))) + 9.29931640625*x3*x50*(-0.742303331118617*x35*(x5 + 6.30666666666667) + 1.48460666223723*x40*(x4*(x5 + 4.27333333333333) + x89 + 4.81333333333333) + x45*(SQRT1MQ2*(-x24*(1.44851667104227*x5 + x52 + 7.4565502756629) + x4*(0.470954756278988*x5 + 1.94696770805986) + 2.56235232344447) + 0.0787608296140719*x44*(x5 - 9.96))) - 3.41796875*x50*(0.258508195495389*x35*(x5 + 5.66666666666667) - 0.517016390990777*x40*(x4*(x5 + 3.83333333333333) + x89 + 4.33333333333333) + x45*(SQRT1MQ2*(x24*(x26 + 1.17142857142857*x5 + 2.656) + x4*(0.716190476190476*x5 - 0.475428571428571) - 0.804571428571429) - 0.0274285714285714*x44*(Y - 3)*(Y + 3))) - 0.0098876953125*x6*x87) + x31*(-LOGV*(x0*(x4*(1655.1880952381*x5 - 995.439682539683) - 2085.8622150263) + x1*(x4*(2868.17321428571*x5 - 1610.27569444444) - 5284.89217109683) + x11*(x4*(37.9396205357143*x5 - 11.7359654017857) - 33.2784345903766) - 7.54882034095204*x12 + x3*(x4*(1019.65267857143*x5 - 454.558928571429) - 3685.43684793338) + x4*(144.704761904762*x5 - 81.2265873015873) - 140.725931015878) - x0*(x21*(11558.6229584116*x5 - 6344.26637684547) + x24*(-5526.03524925595*x26 + 3005.07924107143*x5 + 452.394996279762) - x4*(191.950608151778*x5 - 79.464373199908) + x4*(3902.18551071599*x5 - 2295.40324159764) - x4*(14700.5053934004*x5 - 9139.00064114099) - 18439.7048243933*x8 + 18432.3609274963) - x1*(x21*(18572.2029912043*x5 - 10263.75602778) + x24*(-7748.7728562128*x26 + 4850.46601795015*x5 + 179.411748976935) - x4*(23864.7040311609*x5 - 16337.7641064378) - x4*(44224.7691214479*x5 - 27377.4657461385) + x4*(54813.8624301865*x5 - 33678.656869896) - 38747.616901872*x8 + 48127.0744975669) - x11*(x21*(301.993799469498*x5 - 86.9857445593936) - x24*(346.313074021112*x26 - 152.459958031064*x5 + 6.43029639834449) - x4*(7081.18671735962*x5 - 3232.26067602062) + x4*(368709.905384316*x5 - 233193.261904752) + x4*(3188718.49729252*x5 - 2229057.99755325) - x4*(3552627.45169951*x5 - 2459751.59771572) + 7276.38417818997*x8 - 1601.09946746752) - x12*(-26.4971620920029*x21*(x5 - 0.428835667046842) + x24*(43.4521331787109*x26 - 27.9959411621094*x5 + 2.39520772298177) - x4*(3090.54871924462*x5 - 1463.61656526434) + x4*(7026881.49715288*x5 - 5017505.89867514) - x4*(10381453.9121051*x5 - 7479027.31581336) - x4*(14804018.6518928*x5 - 11022339.5056012) + x4*(18161504.8246331*x5 - 13485420.5736355) + 121.858019542844*x8 + 206.712400376797) + 628.416705488383*x21 - 1222.7667656394*x23 - 56.5856584821429*x24 - 293.105561755952*x25 + 536.848958333333*x27 - x3*(x21*(6958.25991319692*x5 - 3147.4084860836) - x24*(3364.25513857887*x26 - 2339.66339983259*x5 + 162.239920479911) - x4*(14064.7440139995*x5 - 8298.83317124602) + x4*(219613.900662376*x5 - 144758.649013338) + x4*(316125.101978349*x5 - 205768.070776451) - x4*(526346.670223119*x5 - 345433.155819757) - 12919.9362038857*x8 + 15734.0286735697) - 513.309342602164*x4 + 320.488419230719*x6 + 1534.62307943924*x8 - 1066.55185077117) + x51*(5.625*x0*(x45*(SQRT1MQ2*(x24*(x26 + 0.191666666666667*x5 - 1.875) + x4*(4.21666666666667*x5 - 0.166666666666667) + 0.666666666666667) + 0.25*x53) - 2.35619449019234*x88 + 4.71238898038469*x90) + 4.6142578125*x1*(x45*(SQRT1MQ2*(x24*(x26 + 0.180952380952381*x5 - 1.71428571428571) + x4*(3.88571428571429*x5 - 0.152380952380952) + 0.60952380952381) + 0.228571428571429*x53) - 2.15423496246157*x88 + 4.30846992492314*x90) + 0.3955078125*x3*(x45*(SQRT1MQ2*(x24*(x26 + 0.140740740740741*x5 - 1.11111111111111) + x4*(2.64362139917695*x5 - 0.0987654320987654) + 0.395061728395062) + 0.148148148148148*x53) - 1.39626340159546*x88 + 2.79252680319093*x90) + 1.0546875*x45*(SQRT1MQ2*(x24*(x26 + 0.155555555555556*x5 - 1.33333333333333) + x4*(3.10123456790123*x5 - 0.118518518518519) + 0.474074074074074) + 0.177777777777778*x53) - 1.76714586764426*x88 + 3.53429173528852*x90) + x56 - x7*(x0*(2.88020833333333*x8 + 49.6226714606084) + x1*(88.4562872023809*x8 - 147.336151948361) - x11*(x64 - 0.743167720497491) - x12*(x65 - 0.0230763428405865) + x3*(42.8323102678571*x8 - 24.5084881529033) - 11.3973214285714*x8 + 19.4432795331547) - x9*(0.0234375*x0*x86 + 0.0029296875*x1*x86 + 0.0234375*x4*(15*x5 + 1) + 0.125) + 1)

    return fluxE,fluxL,fluxQ


#@njit(fastmath=True)
def roots(q,En,L,Q):
    #q_in,mu,M,eta, t0,IC_0 = initial_parameters ( )
    #En,L,Q = initial_ELQ()
    a =q
    sqrt = cmath.sqrt
    x0 = En**2
    x1 = x0 - 1
    x2 = 1/x1
    x3 = 0.5*x2
    x4 = -x3
    x5 = En*a
    x6 = (-L + x5)**2
    x7 = Q + x6
    x8 = a**2
    x9 = x0*x8
    x10 = 2*x9
    x11 = L*x5
    x12 = 2*x11
    x13 = -x10 + x12 + x8
    x14 = x13 + x7
    x15 = 18*x7
    x16 = -Q - x12
    x17 = L**2
    x18 = x17 + x9
    x19 = x1*x8
    x20 = x19*(x16 + x18 - x6)
    x21 = 36*x20
    x22 = (L - x5)**2
    x23 = x16 - x22
    x24 = x10 + x23 - x8
    x25 = x24**2
    x26 = x19*(x18 + x23)
    x27 = Q + x22
    x28 = 54*x8
    x29 = 54*x1
    x30 = -108*En*L*a**3 + 54*a**4*x0 + x17*x28
    x31 = x24**3 - 36*x24*x26 - 18*x24*x27 + x27**2*x29 - x27*x28 + x30
    x32 = sqrt(x31**2 - (-12*Q - 12*x22 + x25 + 12*x26)**3)
    x33 = -x28*x7 + x29*x7**2 + x30 + x32
    x34 = (-x14**3 + x14*x15 + x14*x21 + x33)**0.333333333333333
    x35 = 15.1190525987385*Q
    x36 = x13 + x27
    x37 = 0.666666666666667*Q + 1.33333333333333*x11 + x2 + 0.666666666666667*x8 - 1.33333333333333*x9
    x38 = (x31 + x32)**0.333333333333333
    x39 = 15.1190525987385*x22
    x40 = 1.25992104989487*x25
    x41 = 15.1190525987385*x26
    x42 = (-x35 - x39 + x40 + x41)/x38
    x43 = 0.666666666666667*x22 + x37
    x44 = (-1.0*Q - 1.0*x22 + x24*x3 - 0.5/x1**2)/sqrt(x2*(0.333333333333333*x38 + 0.2645668419947*x42 + x43))
    x45 = 0.333333333333333*Q + 0.666666666666667*x11 + x2/2 + 0.333333333333333*x22 - 0.0833333333333333*x38 - 0.066141710498675*x42 + 0.333333333333333*x8 - 0.666666666666667*x9
    x46 = (x15*x36 + x21*x36 + x33 - x36**3)**0.333333333333333
    x47 = x8*(1 - x0)
    Er1 = x4 + 1.0*sqrt(x2*(x44 + x45)) + 0.5*sqrt(x2*(0.333333333333333*x34 + x37 + 0.666666666666667*x6 - 0.2645668419947*(-15.1190525987385*x20 + x35 - 1.25992104989487*x36**2 + 15.1190525987385*x6)/x34))

    Er2 = x4 + 1.0*sqrt(x2*(-x44 + x45)) - 0.5*sqrt(x2*(x43 + 0.333333333333333*x46 - 0.2645668419947*(x35 + x39 - x40 - x41)/x46))

    orb_inc = sqrt(x2*(0.5*Q + 0.5*x17 - 0.5*x19 - 0.5*sqrt(-4*Q*x47 + (Q + x17 + x47)**2))/x8 + 1)

    r1 = np.real(Er1)
    r2 = np.real(Er2)
    Y = orb_inc
    #e =(r1-r2)/(r1+r2)
    #p = 2*r1*r2/(r1+r2)
    #Y = np.real(orb_inc)
    #v = np.sqrt(1/p)
    return r1,r2,Y


#@njit(fastmath=True)
def E_roots_numba(a,En,L,Q): #functions to convert COM to apex
    #q_in,mu,M,eta, t0,IC_0 = initial_parameters ( )
    
    #a =q_in
    sqrt = cmath.sqrt
    x0 = En**2
    x1 = x0 - 1
    x2 = 1/x1
    x3 = 0.5*x2
    x4 = -x3
    x5 = En*a
    x6 = (-L + x5)**2
    x7 = Q + x6
    x8 = a**2
    x9 = x0*x8
    x10 = 2*x9
    x11 = L*x5
    x12 = 2*x11
    x13 = -x10 + x12 + x8
    x14 = x13 + x7
    x15 = 18*x7
    x16 = -Q - x12
    x17 = L**2
    x18 = x17 + x9
    x19 = x1*x8
    x20 = x19*(x16 + x18 - x6)
    x21 = 36*x20
    x22 = (L - x5)**2
    x23 = x16 - x22
    x24 = x10 + x23 - x8
    x25 = x24**2
    x26 = x19*(x18 + x23)
    x27 = Q + x22
    x28 = 54*x8
    x29 = 54*x1
    x30 = -108*En*L*a**3 + 54*a**4*x0 + x17*x28
    x31 = x24**3 - 36*x24*x26 - 18*x24*x27 + x27**2*x29 - x27*x28 + x30
    x32 = sqrt(x31**2 - (-12*Q - 12*x22 + x25 + 12*x26)**3)
    x33 = -x28*x7 + x29*x7**2 + x30 + x32
    x34 = (-x14**3 + x14*x15 + x14*x21 + x33)**0.333333333333333
    x35 = 15.1190525987385*Q
    x36 = x13 + x27
    x37 = 0.666666666666667*Q + 1.33333333333333*x11 + x2 + 0.666666666666667*x8 - 1.33333333333333*x9
    x38 = (x31 + x32)**0.333333333333333
    x39 = 15.1190525987385*x22
    x40 = 1.25992104989487*x25
    x41 = 15.1190525987385*x26
    x42 = (-x35 - x39 + x40 + x41)/x38
    x43 = 0.666666666666667*x22 + x37
    x44 = (-1.0*Q - 1.0*x22 + x24*x3 - 0.5/x1**2)/sqrt(x2*(0.333333333333333*x38 + 0.2645668419947*x42 + x43))
    x45 = 0.333333333333333*Q + 0.666666666666667*x11 + x2/2 + 0.333333333333333*x22 - 0.0833333333333333*x38 - 0.066141710498675*x42 + 0.333333333333333*x8 - 0.666666666666667*x9
    x46 = (x15*x36 + x21*x36 + x33 - x36**3)**0.333333333333333
    x47 = x8*(1 - x0)
    Er1 = x4 + 1.0*sqrt(x2*(x44 + x45)) + 0.5*sqrt(x2*(0.333333333333333*x34 + x37 + 0.666666666666667*x6 - 0.2645668419947*(-15.1190525987385*x20 + x35 - 1.25992104989487*x36**2 + 15.1190525987385*x6)/x34))

    Er2 = x4 + 1.0*sqrt(x2*(-x44 + x45)) - 0.5*sqrt(x2*(x43 + 0.333333333333333*x46 - 0.2645668419947*(x35 + x39 - x40 - x41)/x46))

    orb_inc = sqrt(x2*(0.5*Q + 0.5*x17 - 0.5*x19 - 0.5*sqrt(-4*Q*x47 + (Q + x17 + x47)**2))/x8 + 1)


    r1 = np.real(Er1)
    r2 = np.real(Er2)
    e =np.abs((r1-r2)/(r1+r2))
    p = 2*r1*r2/(r1+r2)
    Y = np.real(orb_inc)
    #v = np.sqrt(1/p)
    return p,e,Y

from scipy import optimize

def KerrProSep(a,e,x):

    def SepEquat(p):
            
  
            SepEquat =a**4*(-3 - 2*e + e**2)**2 + p**2*(-6 - 2*e + p)**2 - 2*a**2*(1 + e)*p*(14 + 2*e**2 + 3*p - e*p)
  
            return SepEquat
  
    def SepPolar(p):
              
            SepPolar = a**6*(-1 + e)**2*(1 + e)**4 + p**5*(-6 - 2*e + p) + a**2*p**3*(-4*(-1 + e)*(1 + e)**2 + (3 + e*(2 + 3*e))*p) - a**4*(1 + e)**2*p*(6 + 2*e**3 + 2*e*(-1 + p) - 3*p - 3*e**2*(2 + p))
  
            return SepPolar
            
    int1 = 1+ e       
    int2 = 6 + 2*e
    int3 = 1+np.sqrt(3)+np.sqrt(3+2*np.sqrt(3))
            
    def SepPoly(p):
            
            SepPoly = -4*(3 + e)*p**11 + p**12 + a**12*(-1 + e)**4*(1 + e)**8*(-1 + x)**4*(1 + x)**4 - 4*a**10*(-3 + e)*(-1 + e)**3*(1 + e)**7*p*(-1 + x**2)**4 - 4*a**8*(-1 + e)*(1 + e)**5*p**3*(-1 + x)**3*(1 + x)**3*(7 - 7*x**2 - e**2*(-13 + x**2) + e**3*(-5 + x**2) + 7*e*(-1 + x**2)) + 8*a**6*(-1 + e)*(1 + e)**3*p**5*(-1 + x**2)**2*(3 + e + 12*x**2 + 4*e*x**2 + e**3*(-5 + 2*x**2) + e**2*(1 + 2*x**2)) - 8*a**4*(1 + e)**2*p**7*(-1 + x)*(1 + x)*(-3 + e + 15*x**2 - 5*e*x**2 + e**3*(-5 + 3*x**2) + e**2*(-1 + 3*x**2)) + 4*a**2*p**9*(-7 - 7*e + e**3*(-5 + 4*x**2) + e**2*(-13 + 12*x**2)) + 2*a**8*(-1 + e)**2*(1 + e)**6*p**2*(-1 + x**2)**3*(2*(-3 + e)**2*(-1 + x**2) + a**2*(e**2*(-3 + x**2) - 3*(1 + x**2) + 2*e*(1 + x**2))) - 2*p**10*(-2*(3 + e)**2 + a**2*(-3 + 6*x**2 + e**2*(-3 + 2*x**2) + e*(-2 + 4*x**2))) + a**6*(1 + e)**4*p**4*(-1 + x**2)**2*(-16*(-1 + e)**2*(-3 - 2*e + e**2)*(-1 + x**2) + a**2*(15 + 6*x**2 + 9*x**4 + e**2*(26 + 20*x**2 - 2*x**4) + e**4*(15 - 10*x**2 + x**4) + 4*e**3*(-5 - 2*x**2 + x**4) - 4*e*(5 + 2*x**2 + 3*x**4))) - 4*a**4*(1 + e)**2*p**6*(-1 + x)*(1 + x)*(-2*(11 - 14*e**2 + 3*e**4)*(-1 + x**2) + a**2*(5 - 5*x**2 - 9*x**4 + 4*e**3*x**2*(-2 + x**2) + e**4*(5 - 5*x**2 + x**4) + e**2*(6 - 6*x**2 + 4*x**4))) + a**2*p**8*(-16*(1 + e)**2*(-3 + 2*e + e**2)*(-1 + x**2) + a**2*(15 - 36*x**2 + 30*x**4 + e**4*(15 - 20*x**2 + 6*x**4) + 4*e**3*(5 - 12*x**2 + 6*x**4) + 4*e*(5 - 12*x**2 + 10*x**4) + e**2*(26 - 72*x**2 + 44*x**4)))
            return SepPoly
        
    def derSepPoly(p):
            derSepPoly = -44*(3 + e)*p**10 + 12*p**11 - 4*a**10*(-3 + e)*(-1 + e)**3*(1 + e)**7*(-1 + x**2)**4 - 12*a**8*(-1 + e)*(1 + e)**5*p**2*(-1 + x)**3*(1 + x)**3*(7 - 7*x**2 - e**2*(-13 + x**2) + e**3*(-5 + x**2) + 7*e*(-1 + x**2)) + 40*a**6*(-1 + e)*(1 + e)**3*p**4*(-1 + x**2)**2*(3 + e + 12*x**2 + 4*e*x**2 + e**3*(-5 + 2*x**2) + e**2*(1 + 2*x**2)) - 56*a**4*(1 + e)**2*p**6*(-1 + x)*(1 + x)*(-3 + e + 15*x**2 - 5*e*x**2 + e**3*(-5 + 3*x**2) + e**2*(-1 + 3*x**2)) + 36*a**2*p**8*(-7 - 7*e + e**3*(-5 + 4*x**2) + e**2*(-13 + 12*x**2)) + 4*a**8*(-1 + e)**2*(1 + e)**6*p*(-1 + x**2)**3*(2*(-3 + e)**2*(-1 + x**2) + a**2*(e**2*(-3 + x**2) - 3*(1 + x**2) + 2*e*(1 + x**2))) - 20*p**9*(-2*(3 + e)**2 + a**2*(-3 + 6*x**2 + e**2*(-3 + 2*x**2) + e*(-2 + 4*x**2))) + 4*a**6*(1 + e)**4*p**3*(-1 + x**2)**2*(-16*(-1 + e)**2*(-3 - 2*e + e**2)*(-1 + x**2) + a**2*(15 + 6*x**2 + 9*x**4 + e**2*(26 + 20*x**2 - 2*x**4) + e**4*(15 - 10*x**2 + x**4) + 4*e**3*(-5 - 2*x**2 + x**4) - 4*e*(5 + 2*x**2 + 3*x**4))) - 24*a**4*(1 + e)**2*p**5*(-1 + x)*(1 + x)*(-2*(11 - 14*e**2 + 3*e**4)*(-1 + x**2) + a**2*(5 - 5*x**2 - 9*x**4 + 4*e**3*x**2*(-2 + x**2) + e**4*(5 - 5*x**2 + x**4) + e**2*(6 - 6*x**2 + 4*x**4))) + 8*a**2*p**7*(-16*(1 + e)**2*(-3 + 2*e + e**2)*(-1 + x**2) + a**2*(15 - 36*x**2 + 30*x**4 + e**4*(15 - 20*x**2 + 6*x**4) + 4*e**3*(5 - 12*x**2 + 6*x**4) + 4*e*(5 - 12*x**2 + 10*x**4) + e**2*(26 - 72*x**2 + 44*x**4)))
            return derSepPoly

    def dderSepPoly(p):
            dderSepPoly = -440*(3 + e)*p**9 + 132*p**10 - 24*a**8*(-1 + e)*(1 + e)**5*p*(-1 + x)**3*(1 + x)**3*(7 - 7*x**2 - e**2*(-13 + x**2) + e**3*(-5 + x**2) + 7*e*(-1 + x**2)) + 160*a**6*(-1 + e)*(1 + e)**3*p**3*(-1 + x**2)**2*(3 + e + 12*x**2 + 4*e*x**2 + e**3*(-5 + 2*x**2) + e**2*(1 + 2*x**2)) - 336*a**4*(1 + e)**2*p**5*(-1 + x)*(1 + x)*(-3 + e + 15*x**2 - 5*e*x**2 + e**3*(-5 + 3*x**2) + e**2*(-1 + 3*x**2)) + 288*a**2*p**7*(-7 - 7*e + e**3*(-5 + 4*x**2) + e**2*(-13 + 12*x**2)) + 4*a**8*(-1 + e)**2*(1 + e)**6*(-1 + x**2)**3*(2*(-3 + e)**2*(-1 + x**2) + a**2*(e**2*(-3 + x**2) - 3*(1 + x**2) + 2*e*(1 + x**2))) - 180*p**8*(-2*(3 + e)**2 + a**2*(-3 + 6*x**2 + e**2*(-3 + 2*x**2) + e*(-2 + 4*x**2))) + 12*a**6*(1 + e)**4*p**2*(-1 + x**2)**2*(-16*(-1 + e)**2*(-3 - 2*e + e**2)*(-1 + x**2) + a**2*(15 + 6*x**2 + 9*x**4 + e**2*(26 + 20*x**2 - 2*x**4) + e**4*(15 - 10*x**2 + x**4) + 4*e**3*(-5 - 2*x**2 + x**4) - 4*e*(5 + 2*x**2 + 3*x**4))) - 120*a**4*(1 + e)**2*p**4*(-1 + x)*(1 + x)*(-2*(11 - 14*e**2 + 3*e**4)*(-1 + x**2) + a**2*(5 - 5*x**2 - 9*x**4 + 4*e**3*x**2*(-2 + x**2) + e**4*(5 - 5*x**2 + x**4) + e**2*(6 - 6*x**2 + 4*x**4))) + 56*a**2*p**6*(-16*(1 + e)**2*(-3 + 2*e + e**2)*(-1 + x**2) + a**2*(15 - 36*x**2 + 30*x**4 + e**4*(15 - 20*x**2 + 6*x**4) + 4*e**3*(5 - 12*x**2 + 6*x**4) + 4*e*(5 - 12*x**2 + 10*x**4) + e**2*(26 - 72*x**2 + 44*x**4)))
            return dderSepPoly
        
    pEquatPro = optimize.root_scalar(SepEquat,method='secant',x0 =int1,x1=int2)
    pPolarPro  = optimize.root_scalar(SepPolar,method='secant',x0 =int3,x1=8)
    #root1 = optimize.root_scalar(SepPoly,method='newton',x0 =pEquatPro.root,fprime=derSepPoly)
    #root2 = optimize.root_scalar(SepPoly,method='newton',x0 =pPolarPro.root,fprime=derSepPoly)
    root3 = optimize.root_scalar(SepPoly,method='halley',x0 =pPolarPro.root,fprime=derSepPoly,fprime2=dderSepPoly)
    root4 = optimize.root_scalar(SepPoly,method='halley',x0 =pEquatPro.root,fprime=derSepPoly,fprime2=dderSepPoly)
    if e<0:
            KerrProSep = 1e3 #return large number
    elif root3.root<1:
            KerrProSep = root4.root
    else: 
            KerrProSep = root3.root
    
    return KerrProSep
    
